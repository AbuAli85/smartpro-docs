import{v as j,r as n,j as e,b as v,w as l,B as w,J as k,C as h,f as N,T as C,A as _,E as S}from"./index-DIo96AMZ.js";import{P as D}from"./package-kcN1l2Zs.js";import{C as T}from"./copy-DfLVpXaV.js";import{trackLead as Y,LeadStage as L,getLeadStatus as E}from"./leadTrackingApi-sTmGH8fR.js";import{C as f}from"./circle-BbbW2450.js";function B({submissionId:a,executionId:o,className:p}){const{t:s,language:b}=j(),[d,g]=n.useState([]),[i,c]=n.useState(!1);n.useEffect(()=>{const t=[{id:"submitted",label:s("tracking.step.submitted")||"Request Submitted",status:"completed",timestamp:new Date().toISOString()},{id:"received",label:s("tracking.step.received")||"Request Received",status:"completed",timestamp:new Date().toISOString()},{id:"processing",label:s("tracking.step.processing")||"Processing Your Request",status:"in-progress"},{id:"reviewing",label:s("tracking.step.reviewing")||"Team Reviewing",status:"pending"},{id:"contacting",label:s("tracking.step.contacting")||"We'll Contact You Soon",status:"pending"}];g(t)},[s]);const x=t=>{switch(t){case"completed":return e.jsx(N,{className:"h-5 w-5 text-green-600"});case"in-progress":return e.jsx(h,{className:"h-5 w-5 text-blue-600 animate-pulse"});case"pending":return e.jsx(h,{className:"h-5 w-5 text-gray-400"})}},u=t=>t?t.length>12?`SUB-${t.slice(-8,-4).toUpperCase()}-${t.slice(-4).toUpperCase()}`:t.toUpperCase():"N/A",m=async()=>{if(a)try{const t=u(a);await navigator.clipboard.writeText(t),c(!0),setTimeout(()=>c(!1),2e3)}catch(t){console.error("Failed to copy tracking ID:",t)}};return e.jsx(v,{className:l("p-6 bg-gradient-to-br from-blue-50 via-indigo-50 to-blue-50 border-2 border-blue-300 shadow-lg",p),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(D,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s("tracking.title")||"Track Your Request"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s("tracking.subtitle")||"Keep this ID for your records"})]})]}),a&&e.jsx("div",{className:"bg-white rounded-lg p-4 border-2 border-blue-300 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:s("tracking.submissionId")||"Submission ID"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-mono text-lg font-bold text-gray-900 break-all",children:u(a)}),e.jsx(w,{variant:"ghost",size:"sm",onClick:m,className:"h-8 w-8 p-0 flex-shrink-0","aria-label":i?s("tracking.copied")||"Copied!":s("tracking.copy")||"Copy tracking ID",title:i?s("tracking.copied")||"Copied!":s("tracking.copy")||"Copy tracking ID",children:i?e.jsx(k,{className:"h-4 w-4 text-green-600"}):e.jsx(T,{className:"h-4 w-4 text-gray-600"})})]}),i&&e.jsx("p",{className:"text-xs text-green-600 mt-1 animate-in fade-in",children:s("tracking.copied")||"Copied to clipboard!"})]}),o&&e.jsxs("div",{className:"text-right border-l border-gray-200 pl-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:s("tracking.executionId")||"Execution ID"}),e.jsxs("p",{className:"font-mono text-sm font-semibold text-gray-700",children:[o.slice(0,8).toUpperCase(),"..."]})]})]})}),e.jsx("div",{className:"space-y-3",children:d.map((t,r)=>e.jsxs("div",{className:l("flex items-center gap-3 p-3 rounded-lg transition-colors",t.status==="completed"&&"bg-green-50 border border-green-200",t.status==="in-progress"&&"bg-blue-50 border border-blue-200",t.status==="pending"&&"bg-gray-50 border border-gray-200"),children:[e.jsx("div",{className:"flex-shrink-0",children:x(t.status)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:l("text-sm font-medium",t.status==="completed"&&"text-green-900",t.status==="in-progress"&&"text-blue-900",t.status==="pending"&&"text-gray-600"),children:t.label}),t.timestamp&&e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:new Date(t.timestamp).toLocaleString(b==="ar"?"ar-SA":"en-US",{hour:"2-digit",minute:"2-digit"})})]})]},t.id))}),e.jsx("div",{className:"bg-blue-100 rounded-lg p-4 border border-blue-300",children:e.jsx("p",{className:"text-sm text-blue-900",children:s("tracking.note")||"We typically respond within 24 hours. You'll receive an email confirmation shortly."})})]})})}function q({submissionId:a,email:o,className:p}){const{t:s,language:b}=j(),[d,g]=n.useState([]),[i,c]=n.useState(0),[x,u]=n.useState(!0);n.useEffect(()=>{if(!a){u(!1);return}(async()=>{try{o&&(await Y({submissionId:a,email:o,stage:L.CONSULTATION_VIEWED,metadata:{page:"thank_you",timestamp:new Date().toISOString()}}),S("lead_progress",{submission_id:a,stage:"consultation_viewed"}));const r=await E(a);r?(m(r.stages||[],r.currentStage),c(r.progress||0)):(m(["consultation_submitted","consultation_viewed"],"consultation_viewed"),c(33))}catch(r){console.error("Error initializing lead tracking:",r),m(["consultation_submitted","consultation_viewed"],"consultation_viewed"),c(33)}finally{u(!1)}})()},[a,o]);const m=(t,r)=>{const y=[{id:"consultation_submitted",label:s("lead.stage.consultationSubmitted")||"Consultation Submitted",description:s("lead.stage.consultationSubmittedDesc")||"Your consultation request has been received",completed:t.includes("consultation_submitted"),current:r==="consultation_submitted"},{id:"consultation_viewed",label:s("lead.stage.consultationViewed")||"Thank You Page Viewed",description:s("lead.stage.consultationViewedDesc")||"You viewed the confirmation page",completed:t.includes("consultation_viewed"),current:r==="consultation_viewed"},{id:"registration_started",label:s("lead.stage.registrationStarted")||"Registration Started",description:s("lead.stage.registrationStartedDesc")||"You started creating your account",completed:t.includes("registration_started"),current:r==="registration_started"},{id:"registration_completed",label:s("lead.stage.registrationCompleted")||"Account Created",description:s("lead.stage.registrationCompletedDesc")||"Your account has been successfully created",completed:t.includes("registration_completed"),current:r==="registration_completed"},{id:"profile_completed",label:s("lead.stage.profileCompleted")||"Profile Completed",description:s("lead.stage.profileCompletedDesc")||"Your profile is fully set up",completed:t.includes("profile_completed"),current:r==="profile_completed"},{id:"first_service_booked",label:s("lead.stage.firstServiceBooked")||"First Service Booked",description:s("lead.stage.firstServiceBookedDesc")||"You booked your first service",completed:t.includes("first_service_booked"),current:r==="first_service_booked"}];g(y)};return x||!a?null:e.jsx(v,{className:l("p-6 bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 border-2 border-purple-200 shadow-lg",p),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(C,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s("lead.progress.title")||"Your Journey Progress"}),e.jsx("p",{className:"text-sm text-gray-600",children:s("lead.progress.subtitle")||"Track your progress from consultation to active user"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[i,"%"]}),e.jsx("div",{className:"text-xs text-gray-600",children:s("lead.progress.complete")||"Complete"})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 transition-all duration-500 ease-out",style:{width:`${i}%`}})}),e.jsx("div",{className:"space-y-4",children:d.map((t,r)=>e.jsxs("div",{className:"relative",children:[r<d.length-1&&e.jsx("div",{className:l("absolute left-5 top-10 w-0.5 h-8 transition-colors",t.completed?"bg-green-500":"bg-gray-300")}),e.jsxs("div",{className:l("flex items-start gap-4 p-4 rounded-lg transition-all",t.completed&&"bg-green-50 border border-green-200",t.current&&!t.completed&&"bg-blue-50 border border-blue-200 ring-2 ring-blue-300",!t.completed&&!t.current&&"bg-gray-50 border border-gray-200"),children:[e.jsx("div",{className:"flex-shrink-0",children:t.completed?e.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:e.jsx(N,{className:"h-6 w-6 text-green-600"})}):t.current?e.jsx("div",{className:"p-2 bg-blue-100 rounded-full animate-pulse",children:e.jsx(f,{className:"h-6 w-6 text-blue-600 fill-blue-600"})}):e.jsx("div",{className:"p-2 bg-gray-100 rounded-full",children:e.jsx(f,{className:"h-6 w-6 text-gray-400"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:l("font-semibold",t.completed&&"text-green-900",t.current&&!t.completed&&"text-blue-900",!t.completed&&!t.current&&"text-gray-600"),children:t.label}),t.current&&e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-blue-100 text-blue-700 rounded-full",children:s("lead.progress.current")||"Current"})]}),e.jsx("p",{className:l("text-sm",t.completed&&"text-green-700",t.current&&!t.completed&&"text-blue-700",!t.completed&&!t.current&&"text-gray-500"),children:t.description})]}),t.completed&&e.jsx(_,{className:"h-5 w-5 text-green-600 flex-shrink-0 mt-1"})]})]},t.id))}),i<100&&e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-lg p-4 border border-purple-200",children:[e.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[e.jsxs("strong",{children:[s("lead.progress.nextStep")||"Next Step",":"]})," ",d.find(t=>!t.completed)?.label||s("lead.progress.completeJourney")||"Complete your journey"]}),e.jsx("p",{className:"text-xs text-gray-600",children:s("lead.progress.continueMessage")||"Continue to unlock more features and connect with providers"})]})]})})}export{q as L,B as T};
